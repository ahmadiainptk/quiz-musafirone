<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis Matematika Level 2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- KaTeX CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" xintegrity="sha384-n8MVd4RsNIU0KOVEMVIARBEGPOJpGyo2wLTMbNmutKqBvKDRACJMasIVvBQeWgEC" crossorigin="anonymous">
    <!-- KaTeX JS -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" xintegrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0i8" crossorigin="anonymous"></script>
    <!-- KaTeX Auto-render Extension (untuk fungsi renderMathInElement) -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" xintegrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .quiz-container {
            max-width: 800px;
            margin: auto;
        }
        .answer-btn {
            transition: all 0.2s ease-in-out;
        }
        .answer-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .correct {
            background-color: #22c55e !important; /* Tailwind green-500 */
            color: white !important;
            border-color: #16a34a !important; /* Tailwind green-600 */
        }
        .incorrect {
            background-color: #ef4444 !important; /* Tailwind red-500 */
            color: white !important;
            border-color: #dc2626 !important; /* Tailwind red-600 */
        }
        .modal {
            display: none; /* Hidden by default */
        }
        .modal-content {
            animation: slide-down 0.3s ease-out;
        }
        @keyframes slide-down {
            from {
                transform: translateY(-30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 flex items-center justify-center min-h-screen p-4">

    <div id="quiz-container" class="quiz-container w-full bg-white p-6 sm:p-8 rounded-2xl shadow-lg">
        <div id="quiz-start">
            <h1 class="text-3xl sm:text-4xl font-bold text-center text-slate-700 mb-2">Kuis Olimpiade Matematika</h1>
            <p class="text-center text-slate-500 mb-8">Level 2 (Kelas 3-4 SD/MI)</p>
            <p class="text-center mb-8">Kuis ini terdiri dari 25 soal pilihan ganda. Klik tombol di bawah untuk memulai. Semoga berhasil!</p>
            <button onclick="startQuiz()" class="w-full bg-blue-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-600 transition duration-300 shadow-md">Mulai Kuis</button>
        </div>

        <div id="quiz-content" class="hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl sm:text-2xl font-bold text-slate-700">Soal <span id="question-number"></span> dari 25</h2>
                <div id="timer" class="text-lg font-semibold bg-slate-200 text-slate-700 px-4 py-2 rounded-lg">60:00</div>
            </div>
            <div class="w-full bg-slate-200 rounded-full h-2.5 mb-6">
                <div id="progress-bar" class="bg-blue-500 h-2.5 rounded-full" style="width: 0%"></div>
            </div>
            <p id="question-text" class="text-lg sm:text-xl mb-6 min-h-[60px]"></p>
            <div id="image-container" class="mb-6 flex justify-center"></div>
            <div id="answer-buttons" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <!-- Answer buttons will be generated by JS -->
            </div>
            <div class="mt-8 flex justify-end">
                <button id="next-btn" onclick="nextQuestion()" class="bg-slate-500 text-white font-bold py-3 px-8 rounded-lg hover:bg-slate-600 transition duration-300 hidden">Lanjut</button>
            </div>
        </div>

        <div id="quiz-results" class="hidden text-center">
            <h2 class="text-3xl font-bold text-slate-700 mb-4">Kuis Selesai!</h2>
            <p class="text-xl mb-2">Skor Anda:</p>
            <p id="score-text" class="text-6xl font-bold text-blue-500 mb-8"></p>
            <div id="recommendations" class="text-left bg-slate-50 p-6 rounded-lg border border-slate-200">
                <h3 class="text-xl font-semibold mb-4 text-slate-600">Materi yang Perlu Dipelajari Kembali:</h3>
                <ul id="recommendation-list" class="list-disc list-inside text-slate-600 space-y-2">
                    <!-- Recommendations will be generated by JS -->
                </ul>
                <p id="no-recommendation" class="text-slate-500 hidden">Kerja bagus! Anda telah menguasai semua materi.</p>
            </div>
            <button onclick="restartQuiz()" class="mt-8 w-full bg-blue-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-600 transition duration-300 shadow-md">Ulangi Kuis</button>
        </div>
    </div>

    <!-- Explanation Modal -->
    <div id="explanation-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4">
        <div class="modal-content bg-white p-8 rounded-2xl shadow-lg max-w-lg w-full text-center">
            <h3 class="text-2xl font-bold text-red-500 mb-4">Jawaban Kurang Tepat</h3>
            <p class="text-slate-600 mb-2">Jawaban yang benar adalah:</p>
            <p id="correct-answer-text" class="font-bold text-xl mb-4 text-slate-800"></p>
            <div class="bg-slate-50 p-4 rounded-lg border border-slate-200 text-left">
                <h4 class="font-semibold text-slate-700 mb-2">Pembahasan:</h4>
                <p id="explanation-text" class="text-slate-600"></p>
            </div>
            <button onclick="hideExplanation()" class="mt-6 w-full bg-blue-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-600 transition duration-300">Mengerti</button>
        </div>
    </div>


    <script>
        const quizData = [
            {
                question: "Hasil dari $2\\frac{2}{3} + \\frac{5}{12}$ adalah ...",
                answers: [
                    { text: "$2\\frac{8}{12}$", correct: false },
                    { text: "$3\\frac{1}{12}$", correct: true },
                    { text: "$3\\frac{5}{12}$", correct: false },
                    { text: "$3\\frac{2}{3}$", correct: false }
                ],
                explanation: "Ubah pecahan campuran menjadi pecahan biasa: $2\\frac{2}{3} = \\frac{8}{3}$. Samakan penyebutnya: $\\frac{8}{3} = \\frac{32}{12}$. Kemudian jumlahkan: $\\frac{32}{12} + \\frac{5}{12} = \\frac{37}{12}$. Ubah kembali ke pecahan campuran menjadi $3\\frac{1}{12}$.",
                topic: "Operasi Pecahan"
            },
            {
                question: "$3 \\text{ jam } 48 \\text{ menit } + 5 \\text{ jam } 37 \\text{ menit } = ...$",
                answers: [
                    { text: "8 jam 25 menit", correct: false },
                    { text: "8 jam 85 menit", correct: false },
                    { text: "8 jam 15 menit", correct: false },
                    { text: "9 jam 25 menit", correct: true }
                ],
                explanation: "Jumlahkan menit: $48 + 37 = 85$ menit. Karena 60 menit = 1 jam, maka 85 menit = 1 jam 25 menit. Jumlahkan jam: $3 + 5 + 1$ (dari menit) $= 9$ jam. Jadi, hasilnya 9 jam 25 menit.",
                topic: "Satuan Waktu"
            },
            {
                question: "Sekelompok pekerja sedang mengaspal jalan baru. Mereka butuh 6 hari lebih lama jika mengaspal 120 meter per hari. Jika mereka bisa mengaspal 160 meter per hari, pekerjaan selesai 4 hari lebih cepat. Berapa hari yang dijadwalkan untuk pekerjaan itu?",
                answers: [
                    { text: "34 hari", correct: true },
                    { text: "30 hari", correct: false },
                    { text: "15 hari", correct: false },
                    { text: "14 hari", correct: false }
                ],
                explanation: "Misal D adalah jadwal hari. Panjang jalan sama: $120 \\times (D+6) = 160 \\times (D-4)$. Maka $120D + 720 = 160D - 640$. Pindahkan ruas: $720 + 640 = 160D - 120D$, sehingga $1360 = 40D$. Maka $D = 1360 / 40 = 34$ hari.",
                topic: "Aljabar dan Perbandingan"
            },
             {
                question: "$1.237 \\div 7 = ...$",
                answers: [
                    { text: "176 sisa 7", correct: false },
                    { text: "176 sisa 5", correct: true },
                    { text: "167 sisa 6", correct: false },
                    { text: "167 sisa 4", correct: false }
                ],
                explanation: "Lakukan pembagian bersusun. $1237$ dibagi $7$ menghasilkan $176$ dengan sisa $5$, karena $176 \\times 7 = 1232$, dan $1237 - 1232 = 5$.",
                topic: "Operasi Pembagian"
            },
            {
                question: "Hasil pembulatan dari penjumlahan $8,7 + 28,6$ adalah...",
                answers: [
                    { text: "36", correct: false },
                    { text: "40", correct: false },
                    { text: "38", correct: true },
                    { text: "26", correct: false }
                ],
                explanation: "Ada dua cara. Cara pertama: jumlahkan dulu $8,7 + 28,6 = 37,3$, lalu bulatkan menjadi 37. Cara kedua (yang sesuai pilihan): bulatkan masing-masing bilangan terlebih dahulu. 8,7 dibulatkan menjadi 9 dan 28,6 dibulatkan menjadi 29. Kemudian jumlahkan: $9 + 29 = 38$.",
                topic: "Pembulatan Bilangan Desimal"
            },
            {
                question: "Banyaknya pasangan segitiga yang kongruen (sama dan sebangun) dari gambar jajargenjang di samping adalah...",
                image: "https://i.imgur.com/uRkYfQ2.png",
                answers: [
                    { text: "2 pasangan", correct: false },
                    { text: "3 pasangan", correct: false },
                    { text: "5 pasangan", correct: false },
                    { text: "6 pasangan", correct: true }
                ],
                explanation: "Dalam jajargenjang yang kedua diagonalnya digambar, terbentuk 4 segitiga kecil di dalamnya. Keempat segitiga kecil ini saling kongruen satu sama lain. Jumlah pasangan yang bisa dibentuk dari 4 segitiga adalah 6 pasang.",
                topic: "Geometri Datar (Kekongruenan)"
            },
            {
                question: "Kelipatan persekutuan terkecil dari 72 dan 189 dalam bentuk faktorisasi adalah ...",
                answers: [
                    { text: "$2^2 \\times 3^2 \\times 7$", correct: false },
                    { text: "$2^3 \\times 3^2 \\times 7$", correct: false },
                    { text: "$2^3 \\times 3^3 \\times 7$", correct: true },
                    { text: "$2^3 \\times 3^5 \\times 7$", correct: false }
                ],
                explanation: "Faktorisasi prima dari $72 = 2^3 \\times 3^2$. Faktorisasi prima dari $189 = 3^3 \\times 7$. Untuk KPK, ambil semua faktor prima dengan pangkat tertinggi, yaitu $2^3$, $3^3$, dan $7$. Jadi KPK-nya adalah $2^3 \\times 3^3 \\times 7$.",
                topic: "KPK dan FPB"
            },
            {
                question: "Faktor persekutuan terbesar dari 56, 84, dan 98 adalah...",
                answers: [
                    { text: "12", correct: false },
                    { text: "14", correct: true },
                    { text: "16", correct: false },
                    { text: "21", correct: false }
                ],
                explanation: "Faktorisasi prima: $56 = 2^3 \\times 7$, $84 = 2^2 \\times 3 \\times 7$, $98 = 2 \\times 7^2$. Untuk FPB, ambil faktor prima yang sama dengan pangkat terkecil. Faktor yang sama adalah 2 dan 7. Pangkat terkecil untuk 2 adalah $2^1$ dan untuk 7 adalah $7^1$. Jadi FPB = $2 \\times 7 = 14$.",
                topic: "KPK dan FPB"
            },
            {
                question: "Dalam segitiga ABC, sudut A adalah 40 derajat. Sudut B tiga kali lebih besar dari sudut C. Berapa besar sudut B?",
                answers: [
                    { text: "104 derajat", correct: false },
                    { text: "105 derajat", correct: true },
                    { text: "110 derajat", correct: false },
                    { text: "115 derajat", correct: false }
                ],
                explanation: "Total sudut segitiga adalah 180°. Sisa sudut B + C = 180° - 40° = 140°. Karena B = 3C, maka 3C + C = 140°, sehingga 4C = 140°, dan C = 35°. Maka sudut B = 3 x 35° = 105°.",
                topic: "Sifat-sifat Segitiga"
            },
            {
                question: "Firdha, Sabrina, dan Sekha kursus menari di sanggar yang sama. Firdha berlatih setiap 6 hari sekali, Sabrina setiap 8 hari sekali, dan Sekha setiap 4 hari sekali. Jika pada 9 September 2013 mereka berlatih bersama, mereka akan berlatih bersama lagi pada tanggal ...",
                answers: [
                    { text: "20 September 2013", correct: false },
                    { text: "21 September 2013", correct: false },
                    { text: "2 Oktober 2013", correct: false },
                    { text: "3 Oktober 2013", correct: true }
                ],
                explanation: "Cari KPK dari 4, 6, dan 8. KPK(4, 6, 8) = 24. Mereka akan berlatih bersama lagi 24 hari setelah 9 September. September memiliki 30 hari. Sisa hari di September: $30 - 9 = 21$ hari. Sisa hari lagi: $24 - 21 = 3$ hari. Jadi mereka bertemu lagi pada tanggal 3 Oktober 2013.",
                topic: "KPK dan FPB (Aplikasi)"
            },
             {
                question: "Luas bangun datar tersebut adalah...",
                image: "https://i.imgur.com/7rUeYv2.png",
                answers: [
                    { text: "15 cm²", correct: false },
                    { text: "21 cm²", correct: false },
                    { text: "27 cm²", correct: true },
                    { text: "36 cm²", correct: false }
                ],
                explanation: "Bangun tersebut bisa dibagi menjadi trapesium dan segitiga. Luas Trapesium (bawah): $\\frac{1}{2} \\times (2+8) \\times 3 = 15$ cm². Luas Segitiga (atas): $\\frac{1}{2} \\times 8 \\times 3 = 12$ cm². Total Luas: $15 + 12 = 27$ cm².",
                topic: "Luas Bangun Datar"
            },
            {
                question: "Keliling bangun datar di bawah ini adalah...",
                image: "https://i.imgur.com/k2oTj7s.png",
                answers: [
                    { text: "90 cm", correct: false },
                    { text: "95 cm", correct: false },
                    { text: "185 cm", correct: true },
                    { text: "190 cm", correct: false }
                ],
                explanation: "Keliling adalah jumlah panjang semua sisi luar. Sisi yang diketahui adalah 20 cm, 35 cm, 40 cm, dan ada 2 sisi lain yang sama panjang dengan sisi 20 cm dan 35 cm (karena simetris), serta satu sisi bawah yang sama dengan gabungan alas layang-layang (20cm) dan alas trapesium (35cm). Perkiraan keliling: $20+20+35+40+ (20+35)= 185 cm$.",
                topic: "Keliling Bangun Datar"
            },
            {
                question: "Hasil dari $(3\\frac{1}{4} \\times \\frac{9}{10}) \\div 0,8$ adalah...",
                answers: [
                    { text: "$1\\frac{13}{50}$", correct: false },
                    { text: "$2\\frac{8}{9}$", correct: false },
                    { text: "$3\\frac{21}{32}$", correct: true },
                    { text: "$4\\frac{37}{72}$", correct: false }
                ],
                explanation: "Ubah semua ke pecahan biasa: $3\\frac{1}{4} = \\frac{13}{4}$ dan $0,8 = \\frac{8}{10} = \\frac{4}{5}$. Hitung dalam kurung: $\\frac{13}{4} \\times \\frac{9}{10} = \\frac{117}{40}$. Kemudian bagi: $\\frac{117}{40} \\div \\frac{4}{5} = \\frac{117}{40} \\times \\frac{5}{4} = \\frac{117}{32} = 3\\frac{21}{32}$.",
                topic: "Operasi Pecahan Campuran"
            },
            {
                question: "Halaman kantor tempat ayah bekerja berbentuk persegi panjang dengan ukuran panjang 135 meter dan lebar 85 meter. Keliling halaman kantor tersebut adalah...",
                answers: [
                    { text: "440 m", correct: true },
                    { text: "270 m", correct: false },
                    { text: "220 m", correct: false },
                    { text: "110 m", correct: false }
                ],
                explanation: "Keliling persegi panjang dihitung dengan rumus $2 \\times (p + l)$. Maka kelilingnya adalah $2 \\times (135 + 85) = 2 \\times 220 = 440$ meter.",
                topic: "Keliling Bangun Datar"
            },
            {
                question: "Nilai dari DXL - XXX adalah...",
                answers: [
                    { text: "DX", correct: true },
                    { text: "XD", correct: false },
                    { text: "DL", correct: false },
                    { text: "DM", correct: false }
                ],
                explanation: "Ubah ke angka: DXL = 500 + 40 = 540. XXX = 30. Lakukan pengurangan: $540 - 30 = 510$. Ubah kembali ke bilangan Romawi: 510 = 500 (D) + 10 (X) = DX.",
                topic: "Bilangan Romawi"
            },
            {
                question: "Seorang agen memiliki persediaan 3,5 ton beras. Sebanyak 12 kuintal dikirim ke toko dan 750 kg dikirim ke supermarket. Jika agen menerima kiriman lagi 15 kuintal, beras yang dimiliki agen sekarang adalah...",
                answers: [
                    { text: "1.500 kg", correct: false },
                    { text: "2.500 kg", correct: false },
                    { text: "3.000 kg", correct: false },
                    { text: "3.050 kg", correct: true }
                ],
                explanation: "Samakan semua satuan ke kg: 3,5 ton = 3500 kg; 12 kuintal = 1200 kg; 15 kuintal = 1500 kg. Hitung: $3500 - 1200 - 750 + 1500 = 3050$ kg.",
                topic: "Satuan Berat"
            },
            {
                question: "Ayah memiliki kayu sepanjang 1,8 m dan bambu sepanjang $1\\frac{5}{8}$ m. Pernyataan yang sesuai adalah...",
                answers: [
                    { text: "Bambu milik ayah lebih panjang dari kayu", correct: false },
                    { text: "Kayu milik ayah lebih pendek dari bambu", correct: false },
                    { text: "Kayu milik ayah lebih panjang dari bambu", correct: true },
                    { text: "Kayu dan bambu milik ayah sama panjang", correct: false }
                ],
                explanation: "Ubah bambu ke desimal: $1\\frac{5}{8} = 1 + (5 \\div 8) = 1 + 0,625 = 1,625$ m. Bandingkan: $1,8$ m (kayu) > $1,625$ m (bambu). Jadi, kayu lebih panjang dari bambu.",
                topic: "Perbandingan Desimal dan Pecahan"
            },
            {
                question: "140 + ... = CLII",
                answers: [
                    { text: "10", correct: false },
                    { text: "11", correct: false },
                    { text: "12", correct: true },
                    { text: "13", correct: false }
                ],
                explanation: "Ubah CLII ke angka: C=100, L=50, II=2, jadi CLII = 152. Persamaannya menjadi $140 + x = 152$. Maka $x = 152 - 140 = 12$.",
                topic: "Bilangan Romawi"
            },
            {
                question: "Hasil dari $369 - 79 = ...$",
                answers: [
                    { text: "CCXC", correct: true },
                    { text: "CCC", correct: false },
                    { text: "CCCX", correct: false },
                    { text: "CD", correct: false }
                ],
                explanation: "Lakukan pengurangan: $369 - 79 = 290$. Ubah 290 ke bilangan Romawi: 200 = CC, 90 = XC. Jadi, 290 = CCXC.",
                topic: "Bilangan Romawi"
            },
            {
                question: "Nilai dari XXII - XVII adalah...",
                answers: [
                    { text: "VII", correct: false },
                    { text: "VI", correct: false },
                    { text: "V", correct: true },
                    { text: "IV", correct: false }
                ],
                explanation: "Ubah ke angka: XXII = 22, XVII = 17. Lakukan pengurangan: $22 - 17 = 5$. Angka 5 dalam bilangan Romawi adalah V.",
                topic: "Bilangan Romawi"
            },
            {
                question: "Perhatikan gambar berikut ini! Pernyataan yang tepat adalah...",
                image: "https://i.imgur.com/T0b4D2g.png",
                answers: [
                    { text: "∠A lebih kecil dari ∠B", correct: true },
                    { text: "∠B lebih kecil dari ∠A", correct: false },
                    { text: "∠A lebih besar dari ∠B", correct: false },
                    { text: "∠A sama besar dengan ∠B", correct: false }
                ],
                explanation: "Secara visual, sudut A adalah sudut lancip (kurang dari 90°), sedangkan sudut B adalah sudut tumpul (lebih dari 90°). Oleh karena itu, sudut A lebih kecil dari sudut B.",
                topic: "Jenis-jenis Sudut"
            },
            {
                question: "Dua angka berikutnya dari barisan: 120, 108, 98, 90, ... adalah...",
                answers: [
                    { text: "84, 80", correct: true },
                    { text: "83, 80", correct: false },
                    { text: "84, 82", correct: false },
                    { text: "74, 80", correct: false }
                ],
                explanation: "Perhatikan pola pengurangannya: 120 ke 108 (dikurangi 12), 108 ke 98 (dikurangi 10), 98 ke 90 (dikurangi 8). Pola pengurangnya berkurang 2 setiap langkah. Selanjutnya adalah dikurangi 6 ($90-6=84$) dan dikurangi 4 ($84-4=80$).",
                topic: "Pola Bilangan"
            },
            {
                question: "Di toko sepeda, Fred menghitung ada 23 sepeda (roda dua dan roda tiga). Jika total rodanya ada 59, berapa banyak sepeda roda dua?",
                answers: [
                    { text: "11 sepeda roda dua", correct: false },
                    { text: "12 sepeda roda dua", correct: false },
                    { text: "9 sepeda roda dua", correct: false },
                    { text: "10 sepeda roda dua", correct: true }
                ],
                explanation: "Misal x=sepeda roda dua, y=sepeda roda tiga. Maka $x+y=23$ dan $2x+3y=59$. Dari $x=23-y$, substitusi ke persamaan kedua: $2(23-y)+3y=59$, menjadi $46-2y+3y=59$, sehingga $y=13$. Maka $x=23-13=10$. Ada 10 sepeda roda dua.",
                topic: "Sistem Persamaan Linear"
            },
            {
                question: "Seorang ibu memiliki pita sepanjang 6 yard. Jika untuk membuat satu simpul dibutuhkan $1\\frac{1}{2}$ kaki pita, berapa simpul yang dapat ia buat?",
                answers: [
                    { text: "11", correct: false },
                    { text: "12", correct: true },
                    { text: "13", correct: false },
                    { text: "14", correct: false }
                ],
                explanation: "Samakan satuan. 1 yard = 3 kaki, jadi 6 yard = 18 kaki. Pita per simpul = $1\\frac{1}{2}$ kaki = 1,5 kaki. Jumlah simpul = Total panjang pita / panjang per simpul = $18 \\div 1,5 = 12$ simpul.",
                topic: "Satuan Panjang"
            },
            {
                question: "Hana mempunyai 5 potong pita dengan panjang: 780 mm, 11 cm lebih panjang dari pita pertama, 0,72 m, 6,5 dm, dan 0,123 dam. Berapa panjang keseluruhan pita?",
                answers: [
                    { text: "405 cm", correct: false },
                    { text: "349 cm", correct: false },
                    { text: "427 cm", correct: true },
                    { text: "274 cm", correct: false }
                ],
                explanation: "Ubah semua ke cm: Pita 1=78 cm. Pita 2=78+11=89 cm. Pita 3=72 cm. Pita 4=65 cm. Pita 5=123 cm. Total = $78+89+72+65+123 = 427$ cm.",
                topic: "Satuan Panjang"
            }
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let wrongAnswersTopics = new Set();
        let timerInterval;

        const quizStartEl = document.getElementById('quiz-start');
        const quizContentEl = document.getElementById('quiz-content');
        const quizResultsEl = document.getElementById('quiz-results');
        const questionNumberEl = document.getElementById('question-number');
        const questionTextEl = document.getElementById('question-text');
        const imageContainerEl = document.getElementById('image-container');
        const answerButtonsEl = document.getElementById('answer-buttons');
        const nextBtn = document.getElementById('next-btn');
        const scoreTextEl = document.getElementById('score-text');
        const recommendationListEl = document.getElementById('recommendation-list');
        const noRecommendationEl = document.getElementById('no-recommendation');
        const progressBar = document.getElementById('progress-bar');
        
        const explanationModal = document.getElementById('explanation-modal');
        const explanationTextEl = document.getElementById('explanation-text');
        const correctAnswerTextEl = document.getElementById('correct-answer-text');

        // Opsi untuk KaTeX auto-render
        const katexOptions = {
             delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
             ],
             throwOnError: false
        };

        function startQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            wrongAnswersTopics.clear();
            quizStartEl.classList.add('hidden');
            quizResultsEl.classList.add('hidden');
            quizContentEl.classList.remove('hidden');
            startTimer(60 * 60);
            showQuestion();
        }

        function showQuestion() {
            resetState();
            const currentQuestion = quizData[currentQuestionIndex];
            questionNumberEl.textContent = currentQuestionIndex + 1;
            questionTextEl.innerHTML = currentQuestion.question;

            if (currentQuestion.image) {
                imageContainerEl.innerHTML = `<img src="${currentQuestion.image}" alt="Gambar soal" class="max-w-xs mx-auto rounded-lg">`;
                imageContainerEl.classList.remove('hidden');
            } else {
                imageContainerEl.innerHTML = '';
                imageContainerEl.classList.add('hidden');
            }
            
            currentQuestion.answers.forEach(answer => {
                const button = document.createElement('button');
                button.innerHTML = answer.text;
                button.classList.add('answer-btn', 'w-full', 'p-4', 'border-2', 'border-slate-300', 'rounded-lg', 'text-left', 'hover:bg-slate-100', 'hover:border-blue-500');
                if (answer.correct) {
                    button.dataset.correct = answer.correct;
                }
                button.addEventListener('click', selectAnswer);
                answerButtonsEl.appendChild(button);
            });

            // Panggil render KaTeX secara manual HANYA untuk elemen kuis yang aktif
            renderMathInElement(quizContentEl, katexOptions);

            updateProgressBar();
        }

        function resetState() {
            nextBtn.classList.add('hidden');
            while (answerButtonsEl.firstChild) {
                answerButtonsEl.removeChild(answerButtonsEl.firstChild);
            }
        }
        
        function selectAnswer(e) {
            const selectedBtn = e.target.closest('.answer-btn');
            const isCorrect = selectedBtn.dataset.correct === "true";

            if (isCorrect) {
                score++;
                selectedBtn.classList.add('correct');
            } else {
                const currentQuestion = quizData[currentQuestionIndex];
                wrongAnswersTopics.add(currentQuestion.topic);
                selectedBtn.classList.add('incorrect');
                
                const correctAnswer = currentQuestion.answers.find(ans => ans.correct);
                correctAnswerTextEl.innerHTML = correctAnswer.text;
                explanationTextEl.innerHTML = currentQuestion.explanation;

                // Render KaTeX di dalam modal SEBELUM menampilkannya
                renderMathInElement(explanationModal, katexOptions);
                
                explanationModal.style.display = 'flex';
            }

            Array.from(answerButtonsEl.children).forEach(button => {
                if (button.dataset.correct === "true") {
                    if(!isCorrect) button.classList.add('correct');
                }
                button.disabled = true;
            });

            if(!isCorrect){
                // Tunggu pengguna menutup modal
            } else {
                 if (quizData.length > currentQuestionIndex + 1) {
                    nextBtn.classList.remove('hidden');
                } else {
                    setTimeout(showResults, 1000);
                }
            }
        }

        function hideExplanation(){
            explanationModal.style.display = 'none';
             if (quizData.length > currentQuestionIndex + 1) {
                nextBtn.classList.remove('hidden');
            } else {
                showResults();
            }
        }

hideExplanation();
        
        function showResults() {
            clearInterval(timerInterval);
            quizContentEl.classList.add('hidden');
            quizResultsEl.classList.remove('hidden');
            const scorePercent = Math.round((score / quizData.length) * 100);
            scoreTextEl.textContent = `${scorePercent}%`;

            recommendationListEl.innerHTML = '';
            if (wrongAnswersTopics.size > 0) {
                wrongAnswersTopics.forEach(topic => {
                    const li = document.createElement('li');
                    li.textContent = topic;
                    recommendationListEl.appendChild(li);
                });
                noRecommendationEl.classList.add('hidden');
                recommendationListEl.classList.remove('hidden');

            } else {
                noRecommendationEl.classList.remove('hidden');
                recommendationListEl.classList.add('hidden');
            }
        }

        function nextQuestion() {
            currentQuestionIndex++;
            showQuestion();
        }

        function restartQuiz() {
            quizResultsEl.classList.add('hidden');
            quizStartEl.classList.remove('hidden');
        }
        
        function updateProgressBar() {
            const progressPercentage = ((currentQuestionIndex + 1) / quizData.length) * 100;
            progressBar.style.width = `${progressPercentage}%`;
        }
        
        function startTimer(duration) {
            let timer = duration, minutes, seconds;
            const timerEl = document.getElementById('timer');
            timerInterval = setInterval(function () {
                minutes = parseInt(timer / 60, 10);
                seconds = parseInt(timer % 60, 10);

                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;

                timerEl.textContent = minutes + ":" + seconds;

                if (--timer < 0) {
                    clearInterval(timerInterval);
                    showResults();
                }
            }, 1000);
        }

        // Tidak memanggil auto-render secara global saat halaman dimuat
        // Pemanggilan dilakukan secara manual di dalam fungsi showQuestion dan selectAnswer
    </script>
</body>
</html>

