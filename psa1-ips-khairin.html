<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PAS IPS Kelas 7 - Semester Ganjil</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap');
        body { font-family: 'Nunito', sans-serif; background-color: #f3f4f6; -webkit-tap-highlight-color: transparent; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .option-btn {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .option-btn:hover:not(.disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .option-btn.selected {
            background-color: #eff6ff;
            border-color: #3b82f6;
            color: #1e40af;
        }
        
        /* Nav Grid */
        .grid-btn {
            width: 35px; height: 35px; font-size: 0.8rem;
            display: flex; align-items: center; justify-content: center;
            border-radius: 6px; cursor: pointer; transition: all 0.2s;
        }
        .grid-btn.active { background-color: #3b82f6; color: white; border: none; font-weight: bold; }
        .grid-btn.answered { background-color: #dbeafe; color: #1e40af; border: 1px solid #93c5fd; }
        .grid-btn.unanswered { background-color: white; border: 1px solid #e2e8f0; color: #64748b; }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.3s ease-out forwards; }
    </style>
</head>
<body class="text-slate-800 h-screen flex flex-col overflow-hidden">

    <!-- HEADER -->
    <header class="bg-white shadow-sm border-b border-slate-200 z-20 relative">
        <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="bg-blue-600 text-white p-2 rounded-lg shadow-lg shadow-blue-200">
                    <i class="fas fa-book-open"></i>
                </div>
                <div>
                    <h1 class="font-bold text-lg leading-tight md:text-xl text-slate-800">PAS IPS Kelas 7</h1>
                    <p class="text-xs text-slate-500 font-semibold">Semester Ganjil ‚Ä¢ 50 Soal</p>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <div class="hidden md:flex flex-col items-end">
                    <span class="text-xs text-slate-500 font-bold uppercase tracking-wider">Sisa Waktu</span>
                    <span id="timer" class="font-mono text-xl font-bold text-blue-600">90:00</span>
                </div>
                <button onclick="toggleSidebar()" class="md:hidden text-slate-600 hover:text-blue-600 transition">
                    <i class="fas fa-th-large text-xl"></i>
                </button>
            </div>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden relative">
        
        <!-- SIDEBAR (Question Map) -->
        <aside id="sidebar" class="absolute md:relative inset-y-0 left-0 transform -translate-x-full md:translate-x-0 w-72 bg-white border-r border-slate-200 shadow-xl md:shadow-none transition-transform duration-300 z-30 flex flex-col">
            <div class="p-4 border-b border-slate-100 flex justify-between items-center bg-slate-50">
                <h3 class="font-bold text-slate-700">Peta Soal</h3>
                <span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full font-bold" id="progress-text">0/50</span>
            </div>
            <div class="flex-1 overflow-y-auto p-4">
                <div class="grid grid-cols-5 gap-2" id="question-grid">
                    <!-- Grid generated by JS -->
                </div>
            </div>
            <div class="p-4 border-t border-slate-100 bg-slate-50">
                <div class="flex items-center gap-2 text-xs text-slate-500 mb-4 justify-center">
                    <span class="w-3 h-3 bg-blue-600 rounded"></span> Aktif
                    <span class="w-3 h-3 bg-blue-100 border border-blue-300 rounded ml-2"></span> Dijawab
                    <span class="w-3 h-3 bg-white border border-slate-300 rounded ml-2"></span> Kosong
                </div>
                <button onclick="finishQuiz()" class="w-full bg-slate-800 hover:bg-slate-900 text-white font-bold py-3 rounded-xl shadow-lg shadow-slate-200 transition active:scale-95 flex items-center justify-center gap-2">
                    <i class="fas fa-check-circle"></i> Selesai Ujian
                </button>
            </div>
        </aside>

        <!-- OVERLAY for Mobile Sidebar -->
        <div id="sidebar-overlay" onclick="toggleSidebar()" class="absolute inset-0 bg-black/50 z-20 hidden md:hidden glass-panel"></div>

        <!-- MAIN CONTENT -->
        <main class="flex-1 overflow-y-auto bg-slate-50 relative w-full">
            <div class="max-w-3xl mx-auto p-4 md:p-8 pb-24">
                
                <!-- START SCREEN -->
                <div id="start-screen" class="flex flex-col items-center justify-center min-h-[60vh] text-center fade-in">
                    <div class="w-24 h-24 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mb-6 text-4xl shadow-blue-200 shadow-xl">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <h2 class="text-3xl font-extrabold text-slate-800 mb-3">Siap Mengerjakan?</h2>
                    <p class="text-slate-500 mb-8 max-w-md">Soal disusun berdasarkan Kisi-Kisi PAS Ganjil. Terdiri dari materi Keluarga, Kebutuhan, Praaksara, hingga Interaksi Sosial.</p>
                    <ul class="text-left bg-white p-6 rounded-2xl shadow-sm border border-slate-200 mb-8 text-sm space-y-3 w-full max-w-md">
                        <li class="flex items-center gap-3"><i class="fas fa-clock text-blue-500"></i> Waktu pengerjaan 90 menit</li>
                        <li class="flex items-center gap-3"><i class="fas fa-list-ol text-blue-500"></i> Total 50 butir soal pilihan ganda</li>
                        <li class="flex items-center gap-3"><i class="fas fa-check-double text-blue-500"></i> Cek kembali jawaban sebelum submit</li>
                    </ul>
                    <button onclick="startQuiz()" class="bg-blue-600 text-white px-10 py-4 rounded-full font-bold text-lg shadow-xl shadow-blue-200 hover:bg-blue-700 transition transform hover:-translate-y-1">
                        Mulai Sekarang
                    </button>
                </div>

                <!-- QUESTION CARD -->
                <div id="quiz-container" class="hidden">
                    <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden mb-6 relative">
                        <!-- Progress Line -->
                        <div class="h-1 bg-slate-100 w-full">
                            <div id="progress-bar" class="h-full bg-blue-500 transition-all duration-300" style="width: 0%"></div>
                        </div>
                        
                        <div class="p-6 md:p-8">
                            <div class="flex justify-between items-start mb-6">
                                <span class="text-sm font-bold text-blue-600 bg-blue-50 px-3 py-1 rounded-full border border-blue-100">Soal No. <span id="q-number">1</span></span>
                                <button class="text-slate-400 hover:text-red-500" onclick="resetCurrentAnswer()" title="Hapus Jawaban"><i class="fas fa-eraser"></i></button>
                            </div>
                            
                            <h2 id="q-text" class="text-lg md:text-xl font-bold text-slate-800 mb-8 leading-relaxed">
                                <!-- Question Text Here -->
                            </h2>

                            <div id="options-container" class="space-y-3">
                                <!-- Options Generated Here -->
                            </div>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div class="flex justify-between gap-4">
                        <button onclick="prevQuestion()" id="btn-prev" class="flex-1 bg-white border border-slate-300 text-slate-700 font-bold py-3 rounded-xl hover:bg-slate-50 transition disabled:opacity-50 disabled:cursor-not-allowed">
                            <i class="fas fa-arrow-left mr-2"></i> Sebelumnya
                        </button>
                        <button onclick="nextQuestion()" id="btn-next" class="flex-1 bg-blue-600 text-white font-bold py-3 rounded-xl hover:bg-blue-700 shadow-lg shadow-blue-200 transition">
                            Selanjutnya <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>

                <!-- RESULT SCREEN -->
                <div id="result-screen" class="hidden text-center fade-in py-8">
                    <div class="bg-white p-8 rounded-3xl shadow-xl border border-slate-100 max-w-lg mx-auto">
                        <div class="w-20 h-20 mx-auto rounded-full flex items-center justify-center text-3xl mb-6 shadow-lg" id="score-icon">
                            <!-- Icon -->
                        </div>
                        <h2 class="text-2xl font-bold text-slate-800 mb-1">Hasil Ujian</h2>
                        <p class="text-slate-500 mb-6 text-sm">Nilai akhir Anda</p>
                        
                        <div class="text-6xl font-black text-slate-800 mb-8 tracking-tighter" id="final-score">0</div>
                        
                        <div class="grid grid-cols-3 gap-2 mb-8 text-sm">
                            <div class="bg-green-50 p-3 rounded-xl border border-green-100">
                                <div class="text-green-600 font-bold text-lg" id="total-correct">0</div>
                                <div class="text-green-800 opacity-70">Benar</div>
                            </div>
                            <div class="bg-red-50 p-3 rounded-xl border border-red-100">
                                <div class="text-red-600 font-bold text-lg" id="total-wrong">0</div>
                                <div class="text-red-800 opacity-70">Salah</div>
                            </div>
                            <div class="bg-slate-50 p-3 rounded-xl border border-slate-200">
                                <div class="text-slate-600 font-bold text-lg" id="total-skipped">0</div>
                                <div class="text-slate-800 opacity-70">Kosong</div>
                            </div>
                        </div>

                        <button onclick="location.reload()" class="w-full bg-blue-600 text-white font-bold py-3.5 rounded-xl hover:bg-blue-700 transition shadow-lg shadow-blue-200">
                            Ulangi Ujian
                        </button>
                    </div>
                </div>

            </div>
        </main>
    </div>

<script>
// DATA SOAL (50 SOAL SESUAI KISI-KISI)
const questionsData = [
    // Indikator 1: Fungsi Keluarga
    { text: "Keluarga memberikan rasa kasih sayang dan perhatian kepada anak-anaknya. Hal ini menunjukkan fungsi keluarga sebagai fungsi...", options: ["Proteksi", "Ekonomi", "Afeksi", "Sosialisasi"], answer: 2 },
    // Indikator 2: Agen Sosialisasi
    { text: "Agen sosialisasi yang pertama dan utama bagi seorang anak adalah...", options: ["Sekolah", "Keluarga", "Media massa", "Teman sebaya"], answer: 1 },
    // Indikator 3: Norma
    { text: "Aturan yang bersumber dari hati nurani manusia disebut norma...", options: ["Agama", "Kesopanan", "Kesusilaan", "Hukum"], answer: 2 },
    // Indikator 4: Jenis Kebutuhan
    { text: "Kebutuhan yang harus dipenuhi untuk menjaga kelangsungan hidup manusia disebut kebutuhan...", options: ["Primer", "Sekunder", "Tersier", "Rohani"], answer: 0 },
    // Indikator 5: Fungsi Keluarga (Proteksi)
    { text: "Keluarga memberikan perlindungan fisik dan rasa aman bagi anggotanya dari gangguan pihak luar. Ini adalah fungsi...", options: ["Proteksi", "Biologis", "Sosialisasi", "Ekonomi"], answer: 0 },
    // Indikator 6: Jenis Kebutuhan
    { text: "Olahraga, rekreasi, dan ibadah adalah contoh pemenuhan kebutuhan berdasarkan sifatnya, yaitu kebutuhan...", options: ["Jasmani", "Rohani", "Sekarang", "Masa depan"], answer: 1 },
    // Indikator 7: Faktor Kebutuhan
    { text: "Orang yang tinggal di daerah pegunungan membutuhkan pakaian tebal, sedangkan di pantai membutuhkan pakaian tipis. Faktor yang mempengaruhi kebutuhan tersebut adalah...", options: ["Tingkat pendapatan", "Selera", "Lingkungan alam", "Kemajuan IPTEK"], answer: 2 },
    // Indikator 8: Letak Astronomis
    { text: "Berdasarkan letak astronomisnya (6¬∞LU-11¬∞LS dan 95¬∞BT-141¬∞BT), dampak bagi Indonesia adalah...", options: ["Memiliki iklim subtropis", "Memiliki iklim tropis", "Terbagi menjadi 4 zona waktu", "Sering terjadi gempa bumi"], answer: 1 },
    // Indikator 9: Iklim/Musim
    { text: "Musim hujan di Indonesia biasanya terjadi pada bulan Oktober sampai Maret karena bertiupnya angin...", options: ["Muson Timur", "Muson Barat", "Pasat", "Lokal"], answer: 1 },
    // Indikator 10: Cuaca
    { text: "Keadaan udara pada suatu tempat yang sempit dan dalam waktu yang singkat disebut...", options: ["Iklim", "Musim", "Cuaca", "Atmosfer"], answer: 2 },
    // Indikator 11: Barang Substitusi
    { text: "Jika harga beras mahal, orang beralih makan jagung atau singkong. Hubungan jagung terhadap beras adalah barang...", options: ["Komplementer", "Substitusi", "Mewah", "Illith"], answer: 1 },
    // Indikator 12: Barang Komplementer
    { text: "Motor tidak akan bisa berjalan jika tidak ada bensin. Bensin bagi motor adalah barang...", options: ["Substitusi", "Komplementer", "Bebas", "Ekonomi"], answer: 1 },
    // Indikator 13: Barang Mentah - Jadi
    { text: "Kapas yang dipintal menjadi benang, kemudian ditenun menjadi kain. Dalam proses ini, benang termasuk barang...", options: ["Mentah", "Setengah jadi", "Jadi", "Bebas"], answer: 1 },
    // Indikator 14: Sirkum Pasifik & Mediterania
    { text: "Pengaruh letak geologis Indonesia yang dilalui Sirkum Pasifik dan Mediterania adalah...", options: ["Memiliki tanah yang tandus", "Kaya akan ikan", "Banyak memiliki gunung api aktif", "Sering terjadi badai tropis"], answer: 2 },
    // Indikator 15: Jenis Kebutuhan
    { text: "Menabung untuk biaya pendidikan kuliah nanti termasuk jenis kebutuhan...", options: ["Sekarang", "Masa depan", "Jasmani", "Primer"], answer: 1 },
    // Indikator 16: Zaman Praaksara (Geologis)
    { text: "Zaman tertua di mana bumi masih panas dan belum ada tanda-tanda kehidupan disebut zaman...", options: ["Arkeozoikum", "Paleozoikum", "Mesozoikum", "Neozoikum"], answer: 0 },
    // Indikator 17: Pencemaran Air
    { text: "Membuang limbah pabrik cair langsung ke sungai tanpa diolah dapat menyebabkan...", options: ["Pencemaran udara", "Pencemaran tanah", "Pencemaran air", "Pencemaran suara"], answer: 2 },
    // Indikator 18: Pencemaran Udara
    { text: "Asap kendaraan bermotor dan pembakaran hutan merupakan penyebab utama dari...", options: ["Pencemaran air", "Pencemaran udara", "Pencemaran tanah", "Erosi tanah"], answer: 1 },
    // Indikator 19: Ciri Praaksara (Kehidupan)
    { text: "Pada masa berburu dan mengumpulkan makanan tingkat sederhana, manusia purba hidup secara...", options: ["Menetap", "Nomaden (berpindah-pindah)", "Bercocok tanam", "Membangun desa"], answer: 1 },
    // Indikator 20: Asal Usul Leluhur
    { text: "Nenek moyang bangsa Indonesia yang datang pada gelombang kedua (500 SM) dan membawa kebudayaan logam disebut bangsa...", options: ["Proto Melayu", "Deutro Melayu", "Melanesoid", "Negrito"], answer: 1 },
    // Indikator 21: Interaksi Disosiatif
    { text: "Bentuk interaksi sosial yang mengarah pada perpecahan atau pertentangan disebut...", options: ["Asosiatif", "Disosiatif", "Akulturasi", "Asimilasi"], answer: 1 },
    // Indikator 22: Penyebab Kelangkaan
    { text: "Salah satu faktor penyebab kelangkaan adalah...", options: ["Sumber daya alam yang tidak terbatas", "Kebutuhan manusia yang terbatas", "Pertumbuhan penduduk yang cepat", "Kemampuan produksi yang sangat tinggi"], answer: 2 },
    // Indikator 23: Mencegah Kelangkaan
    { text: "Langkah yang tepat untuk mencegah kelangkaan sumber daya alam adalah...", options: ["Mengeksploitasi sumber daya alam secara besar-besaran", "Menggunakan sumber daya alam secara hemat dan bijak", "Tidak menggunakan sumber daya alam sama sekali", "Menjual semua sumber daya alam ke luar negeri"], answer: 1 },
    // Indikator 24: Dampak Negatif Perdagangan Internasional
    { text: "Salah satu dampak negatif dari perdagangan internasional bagi Indonesia adalah...", options: ["Meningkatkan devisa negara", "Masuknya budaya konsumerisme", "Memperluas lapangan kerja", "Alih teknologi"], answer: 1 },
    // Indikator 25: Akulturasi
    { text: "Percampuran dua budaya atau lebih yang saling bertemu dan mempengaruhi tanpa menghilangkan ciri khas budaya asli disebut...", options: ["Asimilasi", "Akulturasi", "Difusi", "Invasi"], answer: 1 },
    // Indikator 26: Masalah Ekonomi
    { text: "Masalah pokok ekonomi modern terdiri dari...", options: ["Produksi, konsumsi, distribusi", "Barang apa yang diproduksi, bagaimana, dan untuk siapa", "Kapan, di mana, dan siapa pelakunya", "Modal, tenaga kerja, dan pasar"], answer: 1 },
    // Indikator 27: Tentang Kelangkaan
    { text: "Kelangkaan terjadi ketika...", options: ["Kebutuhan < Alat pemuas", "Kebutuhan = Alat pemuas", "Kebutuhan > Alat pemuas", "Alat pemuas berlimpah"], answer: 2 },
    // Indikator 28: Istilah Ekonomi
    { text: "Istilah ekonomi berasal dari bahasa Yunani 'Oikonomia' yang berarti...", options: ["Aturan negara", "Aturan rumah tangga", "Kegiatan jual beli", "Kemakmuran rakyat"], answer: 1 },
    // Indikator 29: Urutan Zaman
    { text: "Urutan zaman geologis dari yang tertua hingga termuda adalah...", options: ["Paleozoikum - Arkeozoikum - Mesozoikum - Neozoikum", "Arkeozoikum - Paleozoikum - Mesozoikum - Neozoikum", "Mesozoikum - Paleozoikum - Arkeozoikum - Neozoikum", "Neozoikum - Mesozoikum - Paleozoikum - Arkeozoikum"], answer: 1 },
    // Indikator 30: Ciri Mesozoikum
    { text: "Zaman di mana hidup hewan-hewan reptil raksasa seperti Dinosaurus disebut zaman...", options: ["Arkeozoikum", "Paleozoikum", "Mesozoikum", "Neozoikum"], answer: 2 },
    // Indikator 31: Pengertian Interaksi Sosial
    { text: "Hubungan timbal balik antara individu dengan individu, individu dengan kelompok, atau kelompok dengan kelompok disebut...", options: ["Status sosial", "Peran sosial", "Interaksi sosial", "Lembaga sosial"], answer: 2 },
    // Indikator 32: Syarat Interaksi
    { text: "Dua syarat terjadinya interaksi sosial adalah...", options: ["Status dan Peran", "Kontak sosial dan Komunikasi", "Simpati dan Empati", "Sugesti dan Imitasi"], answer: 1 },
    // Indikator 33: Interaksi Asosiatif
    { text: "Bentuk interaksi sosial yang mengarah pada kesatuan dan kerjasama disebut...", options: ["Disosiatif", "Asosiatif", "Konflik", "Kompetisi"], answer: 1 },
    // Indikator 34: Bentuk Interaksi
    { text: "Di bawah ini yang termasuk bentuk interaksi sosial disosiatif adalah...", options: ["Kerjasama", "Asimilasi", "Akulturasi", "Persaingan (Kompetisi)"], answer: 3 },
    // Indikator 35: Masa Bercocok Tanam
    { text: "Secara arkeologis, masa di mana manusia mulai menetap dan memproduksi makanan sendiri (food producing) adalah masa...", options: ["Paleolithikum", "Mesolithikum", "Neolithikum", "Megalithikum"], answer: 2 },
    // Indikator 36: Ciri Perundagian
    { text: "Ciri utama zaman perundagian adalah...", options: ["Manusia hidup di gua", "Alat-alat terbuat dari batu kasar", "Mengenal teknik pengolahan logam", "Hidup berpindah-pindah"], answer: 2 },
    // Indikator 37: Faktor Kelangkaan
    { text: "Bencana alam dapat menyebabkan kelangkaan karena...", options: ["Menambah jumlah sumber daya", "Merusak sumber daya yang ada dan mengganggu distribusi", "Meningkatkan kemampuan produksi", "Menurunkan kebutuhan manusia"], answer: 1 },
    // Indikator 38: Melestarikan Udara
    { text: "Upaya yang dapat dilakukan untuk melestarikan sumber daya udara adalah...", options: ["Menebang hutan secara liar", "Menggunakan kendaraan umum dan menanam pohon", "Membakar sampah plastik", "Membangun pabrik di tengah kota"], answer: 1 },
    // Indikator 39: Melestarikan Tanah
    { text: "Untuk mencegah erosi pada tanah miring, upaya yang dilakukan adalah...", options: ["Ladang berpindah", "Terasering (sengkedan)", "Penggunaan pestisida berlebih", "Pembakaran lahan"], answer: 1 },
    // Indikator 40: Pembangunan Berkelanjutan
    { text: "Karakteristik pembangunan berkelanjutan adalah...", options: ["Menghabiskan sumber daya alam saat ini", "Memenuhi kebutuhan saat ini tanpa mengorbankan kebutuhan generasi masa depan", "Hanya berfokus pada keuntungan ekonomi", "Tidak memperhatikan dampak lingkungan"], answer: 1 },
    // Indikator 41: Letak Geografis/Astronomis (Matching -> MC)
    { text: "Letak suatu wilayah berdasarkan kenyataannya di permukaan bumi disebut letak...", options: ["Astronomis", "Geografis", "Geologis", "Ekonomis"], answer: 1 },
    // Indikator 42: Batas Wilayah
    { text: "Secara geografis, Indonesia diapit oleh dua benua, yaitu...", options: ["Asia dan Afrika", "Asia dan Australia", "Australia dan Amerika", "Eropa dan Asia"], answer: 1 },
    // Indikator 43: Contoh Pencemaran (Gambar -> Deskripsi)
    { text: "Penggunaan pupuk kimia dan pestisida yang berlebihan dapat menyebabkan pencemaran...", options: ["Udara", "Air dan Tanah", "Suara", "Cahaya"], answer: 1 },
    // Indikator 44: Pencemaran
    { text: "Limbah rumah tangga seperti deterjen yang dibuang ke selokan menyebabkan pencemaran...", options: ["Udara", "Air", "Tanah", "Suara"], answer: 1 },
    // Indikator 45: Pencemaran
    { text: "Sampah plastik yang sulit terurai jika dibuang sembarangan akan mengakibatkan pencemaran...", options: ["Udara", "Tanah", "Suara", "Atmosfer"], answer: 1 },
    // Indikator 46: Skala Peta (Essay -> MC)
    { text: "Perbandingan jarak pada peta dengan jarak sesungguhnya di lapangan disebut...", options: ["Judul peta", "Legenda", "Skala peta", "Orientasi"], answer: 2 },
    // Indikator 47: Tingkatan Kebutuhan (Essay -> MC)
    { text: "Makanan, pakaian, dan tempat tinggal termasuk dalam kebutuhan...", options: ["Primer", "Sekunder", "Tersier", "Mewah"], answer: 0 },
    // Indikator 48: Mengatasi Pencemaran Tanah (Essay -> MC)
    { text: "Cara yang tepat untuk mengatasi pencemaran tanah akibat sampah plastik adalah...", options: ["Menimbunnya di dalam tanah", "Membakarnya", "Melakukan daur ulang (recycle)", "Membuangnya ke sungai"], answer: 2 },
    // Indikator 49: Norma Hukum (Essay -> MC)
    { text: "Contoh pelaksanaan norma hukum di lingkungan masyarakat adalah...", options: ["Mengucapkan salam saat bertamu", "Menghormati orang tua", "Mematuhi rambu-rambu lalu lintas", "Beribadah tepat waktu"], answer: 2 },
    // Indikator 50: Asosiatif vs Disosiatif (Essay -> MC)
    { text: "Perbedaan mendasar antara interaksi asosiatif dan disosiatif adalah...", options: ["Asosiatif mengarah pada persatuan, disosiatif mengarah pada perpecahan", "Asosiatif bersifat negatif, disosiatif bersifat positif", "Keduanya tidak ada perbedaan", "Asosiatif terjadi di pasar, disosiatif di sekolah"], answer: 0 }
];

// STATE MANAGEMENT
let currentQuestionIndex = 0;
let userAnswers = new Array(questionsData.length).fill(null);
let timeLeft = 90 * 60; // 90 menit dalam detik
let timerInterval;

// DOM ELEMENTS
const startScreen = document.getElementById('start-screen');
const quizContainer = document.getElementById('quiz-container');
const resultScreen = document.getElementById('result-screen');
const questionText = document.getElementById('q-text');
const optionsContainer = document.getElementById('options-container');
const questionNumber = document.getElementById('q-number');
const progressBar = document.getElementById('progress-bar');
const prevBtn = document.getElementById('btn-prev');
const nextBtn = document.getElementById('btn-next');
const sidebar = document.getElementById('sidebar');
const gridContainer = document.getElementById('question-grid');
const overlay = document.getElementById('sidebar-overlay');
const timerDisplay = document.getElementById('timer');

// INITIALIZATION
function initGrid() {
    gridContainer.innerHTML = '';
    questionsData.forEach((_, i) => {
        const btn = document.createElement('div');
        btn.className = 'grid-btn unanswered';
        btn.innerText = i + 1;
        btn.onclick = () => jumpToQuestion(i);
        btn.id = `grid-btn-${i}`;
        gridContainer.appendChild(btn);
    });
}

function startQuiz() {
    startScreen.classList.add('hidden');
    resultScreen.classList.add('hidden');
    quizContainer.classList.remove('hidden');
    quizContainer.classList.add('fade-in');
    
    initGrid();
    loadQuestion(0);
    startTimer();
    updateProgressText();
}

function loadQuestion(index) {
    currentQuestionIndex = index;
    const q = questionsData[index];
    
    // Update UI Texts
    questionNumber.innerText = index + 1;
    questionText.innerText = q.text;
    
    // Progress Bar
    const progress = ((index + 1) / questionsData.length) * 100;
    progressBar.style.width = `${progress}%`;

    // Generate Options
    optionsContainer.innerHTML = '';
    q.options.forEach((opt, i) => {
        const btn = document.createElement('button');
        btn.className = `w-full text-left p-4 rounded-xl border border-slate-200 option-btn hover:border-blue-300 relative ${userAnswers[index] === i ? 'selected' : 'bg-white'}`;
        
        // Add ABC labels
        const label = String.fromCharCode(65 + i); // A, B, C, D
        btn.innerHTML = `<span class="font-bold mr-3 ${userAnswers[index] === i ? 'text-blue-600' : 'text-slate-400'}">${label}.</span> ${opt}`;
        
        btn.onclick = () => selectAnswer(index, i);
        optionsContainer.appendChild(btn);
    });

    // Update Nav Buttons
    prevBtn.disabled = index === 0;
    if (index === questionsData.length - 1) {
        nextBtn.innerHTML = 'Selesai <i class="fas fa-check ml-2"></i>';
        nextBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
        nextBtn.classList.add('bg-green-600', 'hover:bg-green-700');
        nextBtn.onclick = finishQuiz;
    } else {
        nextBtn.innerHTML = 'Selanjutnya <i class="fas fa-arrow-right ml-2"></i>';
        nextBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
        nextBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
        nextBtn.onclick = nextQuestion;
    }

    // Update Grid Highlight
    document.querySelectorAll('.grid-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(`grid-btn-${index}`).classList.add('active');
}

function selectAnswer(qIndex, optionIndex) {
    userAnswers[qIndex] = optionIndex;
    
    // Update Grid Status
    const gridBtn = document.getElementById(`grid-btn-${qIndex}`);
    gridBtn.classList.remove('unanswered');
    gridBtn.classList.add('answered');
    
    // Reload Options to show selection
    loadQuestion(qIndex);
    updateProgressText();
}

function resetCurrentAnswer() {
    userAnswers[currentQuestionIndex] = null;
    const gridBtn = document.getElementById(`grid-btn-${currentQuestionIndex}`);
    gridBtn.classList.remove('answered');
    gridBtn.classList.add('unanswered');
    loadQuestion(currentQuestionIndex);
    updateProgressText();
}

function nextQuestion() {
    if (currentQuestionIndex < questionsData.length - 1) {
        loadQuestion(currentQuestionIndex + 1);
    }
}

function prevQuestion() {
    if (currentQuestionIndex > 0) {
        loadQuestion(currentQuestionIndex - 1);
    }
}

function jumpToQuestion(index) {
    loadQuestion(index);
    if(window.innerWidth < 768) toggleSidebar(); // Close sidebar on mobile after jump
}

function updateProgressText() {
    const answeredCount = userAnswers.filter(a => a !== null).length;
    document.getElementById('progress-text').innerText = `${answeredCount}/${questionsData.length}`;
}

// TIMER LOGIC
function startTimer() {
    clearInterval(timerInterval);
    timerInterval = setInterval(() => {
        timeLeft--;
        const m = Math.floor(timeLeft / 60);
        const s = timeLeft % 60;
        timerDisplay.innerText = `${m}:${s < 10 ? '0' : ''}${s}`;
        
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            finishQuiz();
        }
    }, 1000);
}

// SIDEBAR LOGIC
function toggleSidebar() {
    const isMobile = window.innerWidth < 768;
    if (isMobile) {
        const isOpen = !sidebar.classList.contains('-translate-x-full');
        if (isOpen) {
            sidebar.classList.add('-translate-x-full');
            overlay.classList.add('hidden');
        } else {
            sidebar.classList.remove('-translate-x-full');
            overlay.classList.remove('hidden');
        }
    }
}

// FINISH & SCORING
function finishQuiz() {
    if (confirm('Apakah Anda yakin ingin menyelesaikan ujian ini?')) {
        clearInterval(timerInterval);
        calculateScore();
    }
}

function calculateScore() {
    let score = 0;
    let correct = 0;
    let wrong = 0;
    let skipped = 0;

    userAnswers.forEach((ans, i) => {
        if (ans === null) {
            skipped++;
        } else if (ans === questionsData[i].answer) {
            score++;
            correct++;
        } else {
            wrong++;
        }
    });

    const finalScoreValue = Math.round((score / questionsData.length) * 100);
    
    // DOM Updates
    document.getElementById('final-score').innerText = finalScoreValue;
    document.getElementById('total-correct').innerText = correct;
    document.getElementById('total-wrong').innerText = wrong;
    document.getElementById('total-skipped').innerText = skipped;

    // Score Icon/Color
    const scoreIcon = document.getElementById('score-icon');
    if(finalScoreValue >= 80) {
        scoreIcon.innerHTML = 'üèÜ';
        scoreIcon.className = 'w-24 h-24 mx-auto rounded-full flex items-center justify-center text-5xl mb-6 shadow-lg bg-green-100 text-green-600';
    } else if (finalScoreValue >= 60) {
        scoreIcon.innerHTML = 'üëç';
        scoreIcon.className = 'w-24 h-24 mx-auto rounded-full flex items-center justify-center text-5xl mb-6 shadow-lg bg-blue-100 text-blue-600';
    } else {
        scoreIcon.innerHTML = 'üìö';
        scoreIcon.className = 'w-24 h-24 mx-auto rounded-full flex items-center justify-center text-5xl mb-6 shadow-lg bg-red-100 text-red-600';
    }

    quizContainer.classList.add('hidden');
    resultScreen.classList.remove('hidden');
}

</script>
</body>
</html>

